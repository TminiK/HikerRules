<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>TyrantGenesis 自制组件</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.12/lib/index.css"/>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        .douyu-search {
            margin-top: 36px;
        }
    </style>
</head>
<body>
<div id="app">
    <van-search class="douyu-search" v-model="search" placeholder="请输入搜索关键词" @search="hikerSearch" />
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vant@2.12/lib/vant.min.js"></script>
<script>
    function newPage (search) {
        alert(getVar('sb'))
        fy_bridge_app.newPage(`搜索：${search}`, $(search).rule(_ => {
            eval(fetch('hiker://files/TyrantG/LIVE/douyu.js'))
            searchParse()
        }))
    }
    new Vue({
        el: '#app',
        data() {
            return {
                search: '',
            }
        },
        methods: {
            hikerSearch() {
                if (! this.search) {
                    vant.Notify({ type: 'warning', message: '请输入搜索内容！' });
                    return false
                }
                const searchUrl = `https://m.douyu.com/api/search/anchor?limit=10&offset=fypage@-1@*10@&sk=${this.search};POST`
                newPage(searchUrl)
            },
        },
    });
</script>
</body>
</html>